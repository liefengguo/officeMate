from PyQt5.QtCore import QSettings, pyqtSignal, QObject

# Mapping of original Chinese texts to translations
SUPPORTED_LANGUAGES = {
    "zh": "中文",
    "en": "English",
    "es": "Español",
    "pt": "Português",
    "ja": "日本語",
    "de": "Deutsch",
    "fr": "Français",
    "ru": "Русский",
    "ko": "한국어",
}

# Mapping of original Chinese texts to translations
_TRANSLATIONS = {
    "DocSnap 文档助手": {"en": "DocSnap Assistant"},
    "DocSnap 文档管理主页": {
        "en": "DocSnap Dashboard",
        "es": "Panel de Documentos DocSnap",
        "pt": "Painel DocSnap",
        "ja": "DocSnap \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u7ba1\u7406\u30db\u30fc\u30e0",
        "de": "DocSnap Dokumentverwaltung",
        "fr": "Tableau de bord DocSnap",
        "ru": "\u0413\u043b\u0430\u0432\u043d\u0430\u044f DocSnap",
        "ko": "DocSnap \ubb38\uc11c \uad00\ub9ac \ud648",
    },
    "📂 已添加文档列表": {
        "en": "📂 Added Documents",
        "es": "\ud83d\udcc2 Documentos a\u00f1adidos",
        "pt": "\ud83d\udcc2 Documentos adicionados",
        "ja": "\ud83d\udcc2 \u8ffd\u52a0\u3055\u308c\u305f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",
        "de": "\ud83d\udcc2 Hinzugef\u00fcgte Dokumente",
        "fr": "\ud83d\udcc2 Documents ajout\u00e9s",
        "ru": "\ud83d\udcc2 \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b",
        "ko": "\ud83d\udcc2 \ucd94\uac00\ub41c \ubb38\uc11c",
    },
    "➕ 添加项目": {
        "en": "➕ Add Project",
        "es": "\u2795 A\u00f1adir proyecto",
        "pt": "\u2795 Adicionar projeto",
        "ja": "\u2795 \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u8ffd\u52a0",
        "de": "\u2795 Projekt hinzuf\u00fcgen",
        "fr": "\u2795 Ajouter un projet",
        "ru": "\u2795 \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u043e\u0435\u043a\u0442",
        "ko": "\u2795 \ud504\ub85c\uc81d\ud2b8 \ucd94\uac00",
    },
    "暂无文档，点击上方按钮添加": {
        "en": "No documents yet, click the button above to add",
        "es": "A\u00fan no hay documentos, haz clic en el bot\u00f3n de arriba para agregar",
        "pt": "Nenhum documento; clique no bot\u00e3o acima para adicionar",
        "ja": "\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u304c\u3042\u308a\u307e\u305b\u3093\u3002\u4e0a\u306e\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u8ffd\u52a0\u3057\u3066\u304f\u3060\u3055\u3044",
        "de": "Keine Dokumente. Bitte oben auf den Button klicken, um hinzuzuf\u00fcgen",
        "fr": "Aucun document. Cliquez sur le bouton ci-dessus pour ajouter",
        "ru": "\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u043d\u0435\u0442. \u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043a\u043d\u043e\u043f\u043a\u0443 \u0432\u044b\u0448\u0435, \u0447\u0442\u043e\u0431\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c",
        "ko": "\ubb38\uc11c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \uc704\uc758 \ubc84\ud2bc\uc744 \ub204\ub974\uc5b4 \ucd94\uac00\ud558\uc138\uc694",
    },
    "选择文档": {
        "en": "Select Document",
        "es": "Seleccionar documento",
        "pt": "Selecionar documento",
        "ja": "\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3092\u9078\u629e",
        "de": "Dokument ausw\u00e4hlen",
        "fr": "S\u00e9lectionner un document",
        "ru": "\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442",
        "ko": "\ubb38\uc11c \uc120\ud0dd",
    },
    "文档 (*.txt *.docx);;所有文件 (*)": {
        "en": "Documents (*.txt *.docx);;All files (*)",
        "es": "Documentos (*.txt *.docx);;Todos los archivos (*)",
        "pt": "Documentos (*.txt *.docx);;Todos os arquivos (*)",
        "ja": "\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8 (*.txt *.docx);;\u3059\u3079\u3066\u306e\u30d5\u30a1\u30a4\u30eb (*)",
        "de": "Dokumente (*.txt *.docx);;Alle Dateien (*)",
        "fr": "Documents (*.txt *.docx);;Tous les fichiers (*)",
        "ru": "\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b (*.txt *.docx);;\u0412\u0441\u0435 \u0444\u0430\u0439\u043b\u044b (*)",
        "ko": "\ubb38\uc11c (*.txt *.docx);;\ubaa8\ub4e0 \ud30c\uc77c (*)",
    },
    "文件不存在": {
        "en": "File not found",
        "es": "Archivo no encontrado",
        "pt": "Arquivo n\u00e3o encontrado",
        "ja": "\u30d5\u30a1\u30a4\u30eb\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093",
        "de": "Datei nicht gefunden",
        "fr": "Fichier introuvable",
        "ru": "\u0424\u0430\u0439\u043b \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d",
        "ko": "\ud30c\uc77c\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4",
    },
    "该文件无法访问：\n{path}": {
        "en": "Cannot access file:\n{path}",
        "es": "No se puede acceder al archivo:\n{path}",
        "pt": "N\u00e3o \u00e9 poss\u00edvel acessar o arquivo:\n{path}",
        "ja": "\u30d5\u30a1\u30a4\u30eb\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u305b\u3093:\n{path}",
        "de": "Auf Datei kann nicht zugegriffen werden:\n{path}",
        "fr": "Impossible d'acc\u00e9der au fichier :\n{path}",
        "ru": "\u041d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0444\u0430\u0439\u043b\u0443:\n{path}",
        "ko": "\ud30c\uc77c\uc5d0 \uc811\uadfc\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4:\n{path}",
    },
    "无法访问：{path}": {
        "en": "Cannot access: {path}",
        "es": "No se puede acceder: {path}",
        "pt": "N\u00e3o \u00e9 poss\u00edvel acessar: {path}",
        "ja": "\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u305b\u3093: {path}",
        "de": "Zugriff nicht m\u00f6glich: {path}",
        "fr": "Impossible d'acc\u00e8s : {path}",
        "ru": "\u041d\u0435\u043b\u044c\u0437\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0438\u0442\u044c: {path}",
        "ko": "\uc811\uadfc\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4: {path}",
    },
    "快照历史": {"en": "Snapshot History"},
    "← 返回主页": {"en": "\u2190 Back"},
    "文档：{name}": {"en": "Document: {name}"},
    "对比选中快照": {"en": "Compare Selected"},
    "查看快照内容": {"en": "View Snapshot"},
    "暂无快照记录": {"en": "No snapshots"},
    "未知时间": {"en": "Unknown"},
    "提示": {"en": "Notice"},
    "选择错误": {"en": "Selection Error"},
    "请选择两个快照进行对比": {"en": "Please select two snapshots to compare"},
    "请至少选择一个快照进行预览": {"en": "Please select at least one snapshot to preview"},
    "快照差异对比": {"en": "Snapshot Diff"},
    "成功": {"en": "Success"},
    "快照已创建！\n时间：{timestamp}": {"en": "Snapshot created!\nTime: {timestamp}"},
    "错误": {"en": "Error"},
    "创建快照失败：{e}": {"en": "Failed to create snapshot: {e}"},
    "⚠️ 没有可用快照进行对比": {"en": "No snapshot available for comparison"},
    "历史对比": {"en": "History"},
    "最新文档": {"en": "Latest"},
    "当前文档与最新快照没有任何差异。": {"en": "No difference between current file and latest snapshot."},
    "对比失败：{e}": {"en": "Comparison failed: {e}"},
    "👉 在左侧填写备注并点击“创建快照”": {"en": "\uD83D\uDC49 Enter remarks on the left then click 'Create Snapshot'"},
    "✅ 快照已创建！": {"en": "\u2705 Snapshot created!"},
    "📜 {name} 的快照历史": {"en": "📜 Snapshot history of {name}"},
    "删除所选快照": {"en": "Delete Selected"},
    "恢复所选快照": {"en": "Restore Selected"},
    "👉 选择快照查看内容或恢复": {"en": "\uD83D\uDC49 Select a snapshot to view or restore"},
    "确定删除该快照？": {"en": "Delete this snapshot?"},
    "✂️ 已删除快照": {"en": "Snapshot deleted"},
    "无法读取快照内容：{e}": {"en": "Unable to load snapshot: {e}"},
    "对比当前与最新": {"en": "Compare with Latest"},
    "开始对比": {"en": "Compare"},
    "未实现的面板模式": {"en": "Panel mode not implemented"},
    "快照备注：": {"en": "Snapshot note:"},
    "输入此版本的备注信息…": {"en": "Enter notes for this version…"},
    "创建快照": {"en": "Create Snapshot"},
    "快照历史：": {"en": "Snapshot history:"},
    "选择需要对比的两个快照：": {"en": "Select two snapshots to compare:"},
    "开始对比": {"en": "Compare"},
    "📭 没有快照可用": {"en": "No snapshots available"},
    "👉 请选择两个快照后点击“对比”": {"en": "Select two snapshots then click 'Compare'"},
    "两个快照无差异。": {"en": "No differences between snapshots."},
    "删除快照": {"en": "Delete Snapshot"},
    "加载内容失败：{e}": {"en": "Failed to load content: {e}"},
    "差异结果将在这里显示...": {"en": "Diff results will appear here..."},
    "没有检测到差异。": {"en": "No differences detected."},
    "快照内容预览": {"en": "Snapshot Preview"},
    "主题(&T)": {
        "en": "Theme(&T)",
        "es": "Tema(&T)",
        "pt": "Tema(&T)",
        "ja": "\u30c6\u30fc\u30de(&T)",
        "de": "Thema(&T)",
        "fr": "Th\u00e8me(&T)",
        "ru": "\u0422\u0435\u043c\u0430(&T)",
        "ko": "\ud14c\ub9c8(&T)",
    },
    "跟随系统": {
        "en": "System",
        "es": "Sistema",
        "pt": "Sistema",
        "ja": "\u30b7\u30b9\u30c6\u30e0",
        "de": "System",
        "fr": "Syst\u00e8me",
        "ru": "\u0421\u0438\u0441\u0442\u0435\u043c\u043d\u0430\u044f",
        "ko": "\uc2dc\uc2a4\ud15c",
    },
    "浅色": {
        "en": "Light",
        "es": "Claro",
        "pt": "Claro",
        "ja": "\u30e9\u30a4\u30c8",
        "de": "Hell",
        "fr": "Clair",
        "ru": "\u0421\u0432\u0435\u0442\u043b\u0430\u044f",
        "ko": "\ub77c\uc774\ud2b8",
    },
    "深色": {
        "en": "Dark",
        "es": "Oscuro",
        "pt": "Escuro",
        "ja": "\u30c0\u30fc\u30af",
        "de": "Dunkel",
        "fr": "Sombre",
        "ru": "\u0422\u0435\u043c\u043d\u0430\u044f",
        "ko": "\ub2e4\ud06c",
    },
    "对比选中的两个快照": {
        "en": "Compare Selected Snapshots",
        "es": "Comparar las dos seleccionadas",
        "pt": "Comparar os dois selecionados",
        "ja": "\u9078\u629e\u3057\u305f2\u3064\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u6bd4\u8f83",
        "de": "Zwei ausgew\u00e4hlte Snapshots vergleichen",
        "fr": "Comparer les deux s\u00e9lectionn\u00e9s",
        "ru": "\u0421\u0440\u0430\u0432\u043d\u0438\u0442\u044c \u0434\u0432\u0430 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0445 \u0441\u043d\u0430\u043f\u0448\u043e\u0442\u0430",
        "ko": "\uc120\ud0dd\ub41c 2\uac1c \uc2a4\ub0a0\uc0f7 \ube44\uad50",
    },
    "⚙ 软件设置": {
        "en": "⚙ Settings",
        "es": "⚙ Configuraci\u00f3n",
        "pt": "⚙ Configura\u00e7\u00f5es",
        "ja": "⚙ \u8a2d\u5b9a",
        "de": "⚙ Einstellungen",
        "fr": "⚙ Param\u00e8tres",
        "ru": "⚙ \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",
        "ko": "⚙ \uc124\uc815",
    },
    "启动时自动检查更新": {
        "en": "Check for updates on startup",
        "es": "Comprobar actualizaciones al iniciar",
        "pt": "Verificar atualiza\u00e7\u00f5es ao iniciar",
        "ja": "\u8d77\u52d5\u6642\u306b\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u3092\u78ba\u8a8d",
        "de": "Beim Start nach Updates suchen",
        "fr": "V\u00e9rifier les mises \u00e0 jour au d\u00e9marrage",
        "ru": "\u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435",
        "ko": "\uc2dc\uc791 \uc2dc \uc5c5\ub370\uc774\ud2b8 \ud655\uc778",
    },
    "启用实验功能": {
        "en": "Enable experimental features",
        "es": "Activar funciones experimentales",
        "pt": "Habilitar recursos experimentais",
        "ja": "\u5b9f\u9a13\u7684\u306a\u6a5f\u80fd\u3092\u6709\u52b9\u5316",
        "de": "Experimentelle Funktionen aktivieren",
        "fr": "Activer les fonctionnalit\u00e9s exp\u00e9rimentales",
        "ru": "\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438",
        "ko": "\uc2e4\ud5d8 \uae30\ub2a5 \ud65c\uc131\ud654",
    },
    "界面语言：": {
        "en": "Language:",
        "es": "Idioma:",
        "pt": "Idioma:",
        "ja": "\u8a00\u8a9e:",
        "de": "Sprache:",
        "fr": "Langue :",
        "ru": "\u042f\u0437\u044b\u043a:",
        "ko": "\uc5b8\uc5b4:",
    },
    "常规": {
        "en": "General",
        "es": "General",
        "pt": "Geral",
        "ja": "\u4e00\u822c",
        "de": "Allgemein",
        "fr": "G\u00e9n\u00e9ral",
        "ru": "\u041e\u0431\u0449\u0438\u0435",
        "ko": "\uc77c\ubc18",
    },
    "外观": {
        "en": "Appearance",
        "es": "Apariencia",
        "pt": "Apar\u00eancia",
        "ja": "\u5916\u89c0",
        "de": "Aussehen",
        "fr": "Apparence",
        "ru": "\u0412\u043d\u0435\u0448\u043d\u0438\u0439 \u0432\u0438\u0434",
        "ko": "\ub9c8\uc74c\uc0c9",
    },
    "快照便捷对比": {
        "en": "Quick snapshot compare",
        "es": "Comparaci\u00f3n r\u00e1pida de instant\u00e1neas",
        "pt": "Compara\u00e7\u00e3o r\u00e1pida de snapshots",
        "ja": "\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u7c21\u6613\u6bd4\u8f83",
        "de": "Schneller Snapshot-Vergleich",
        "fr": "Comparaison rapide des snapshots",
        "ru": "\u0411\u044b\u0441\u0442\u0440\u043e\u0435 \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0435 \u0441\u043d\u0430\u043f\u0448\u043e\u0442\u043e\u0432",
        "ko": "\uc2a4\ub0a0\uc0f7 \ube60\ub978 \ube44\uad50",
    },
    "快照": {
        "en": "Snapshots",
        "es": "Instant\u00e1neas",
        "pt": "Snapshots",
        "ja": "\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8",
        "de": "Snapshots",
        "fr": "Snapshots",
        "ru": "\u0421\u043d\u0430\u043f\u0448\u043e\u0442\u044b",
        "ko": "\uc2a4\ub0a0\uc0f7",
    },
    "差异检测": {
        "en": "Diff Options",
        "es": "Opciones de diferencia",
        "pt": "Op\u00e7\u00f5es de diferen\u00e7a",
        "ja": "\u5dee\u5206\u30aa\u30d7\u30b7\u30e7\u30f3",
        "de": "Diff-Optionen",
        "fr": "Options de diff",
        "ru": "\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f",
        "ko": "\ucc28\uc774 \uc635\uc158",
    },
    "检测粗体变化": {
        "en": "Detect bold changes",
        "es": "Detectar cambios en negrita",
        "pt": "Detectar altera\u00e7\u00f5es de negrito",
        "ja": "\u592a\u5b57\u306e\u5909\u5316\u3092\u691c\u51fa",
        "de": "Fettschrift\u00e4nderungen erkennen",
        "fr": "D\u00e9tecter les changements de gras",
        "ru": "\u041e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0436\u0438\u0440\u043d\u043e\u0433\u043e \u0448\u0440\u0438\u0444\u0442\u0430",
        "ko": "\uad75\uac8c \ubcc0\uacbd \uac10\uc9c0",
    },
    "检测斜体变化": {
        "en": "Detect italic changes",
        "es": "Detectar cambios en cursiva",
        "pt": "Detectar altera\u00e7\u00f5es de it\u00e1lico",
        "ja": "\u659c\u4f53\u306e\u5909\u5316\u3092\u691c\u51fa",
        "de": "Kursiv\u00e4nderungen erkennen",
        "fr": "D\u00e9tecter les changements d'italique",
        "ru": "\u041e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043a\u0443\u0440\u0441\u0438\u0432\u0430",
        "ko": "\uc774\ud0c8\ub9ad \ubcc0\uacbd \uac10\uc9c0",
    },
    "检测下划线变化": {
        "en": "Detect underline changes",
        "es": "Detectar cambios de subrayado",
        "pt": "Detectar altera\u00e7\u00f5es de sublinhado",
        "ja": "\u4e0b\u7dda\u306e\u5909\u5316\u3092\u691c\u51fa",
        "de": "Unterstreichungs\u00e4nderungen erkennen",
        "fr": "D\u00e9tecter les changements de soulignement",
        "ru": "\u041e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043f\u043e\u0434\u0447\u0435\u0440\u043a\u0438\u0432\u0430\u043d\u0438\u044f",
        "ko": "\ubcf5\uc7a1 \ubcc0\uacbd \uac10\uc9c0",
    },
    "检测字体名称差异": {
        "en": "Detect font name changes",
        "es": "Detectar cambios de tipo de letra",
        "pt": "Detectar mudan\u00e7as de fonte",
        "ja": "\u30d5\u30a9\u30f3\u30c8\u540d\u306e\u7570\u52d5\u3092\u691c\u51fa",
        "de": "Schriftart\u00e4nderungen erkennen",
        "fr": "D\u00e9tecter les changements de police",
        "ru": "\u041e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0448\u0440\u0438\u0444\u0442\u0430",
        "ko": "\uae00\uae30 \uc774\ub984 \ubcc0\uacbd \uac10\uc9c0",
    },
    "检测字体颜色差异": {
        "en": "Detect font color changes",
        "es": "Detectar cambios de color de fuente",
        "pt": "Detectar mudan\u00e7as de cor da fonte",
        "ja": "\u30d5\u30a9\u30f3\u30c8\u30ab\u30e9\u30fc\u306e\u5909\u5316\u3092\u691c\u51fa",
        "de": "Schriftfarben\u00e4nderungen erkennen",
        "fr": "D\u00e9tecter les changements de couleur de police",
        "ru": "\u041e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0446\u0432\u0435\u0442\u0430 \u0448\u0440\u0438\u0444\u0442\u0430",
        "ko": "\uae00\uae30 \uc0c9\uc0c1 \ubcc0\uacbd \uac10\uc9c0",
    },
    "检测字体大小差异": {
        "en": "Detect font size changes",
        "es": "Detectar cambios de tama\u00f1o de fuente",
        "pt": "Detectar mudan\u00e7as de tamanho da fonte",
        "ja": "\u30d5\u30a9\u30f3\u30c8\u30b5\u30a4\u30ba\u306e\u5909\u5316\u3092\u691c\u51fa",
        "de": "Schriftgr\u00f6\u00dfen\u00e4nderungen erkennen",
        "fr": "D\u00e9tecter les changements de taille de police",
        "ru": "\u041e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0448\u0440\u0438\u0444\u0442\u0430",
        "ko": "\uae00\uae30 \ud06c\uae30 \ubcc0\uacbd \uac10\uc9c0",
    },
    "检测行间距差异": {
        "en": "Detect line spacing changes",
        "es": "Detectar cambios de interlineado",
        "pt": "Detectar mudan\u00e7as de espa\u00e7amento de linha",
        "ja": "\u884c\u9593\u30b9\u30da\u30fc\u30b9\u306e\u5909\u5316\u3092\u691c\u51fa",
        "de": "Zeilenabstands\u00e4nderungen erkennen",
        "fr": "D\u00e9tecter les changements d'interligne",
        "ru": "\u041e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043c\u0435\u0436\u0441\u0442\u0440\u043e\u0447\u043d\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b\u0430",
        "ko": "\ud589 \uac04\uaca9 \ubcc0\uacbd \uac10\uc9c0",
    },
    "检测段落对齐方式": {
        "en": "Detect paragraph alignment",
        "es": "Detectar alineaci\u00f3n de p\u00e1rrafos",
        "pt": "Detectar alinhamento de par\u00e1grafos",
        "ja": "\u6bb5\u843d\u306e\u5bfe\u5fc3\u3092\u691c\u51fa",
        "de": "Absatzausrichtung erkennen",
        "fr": "D\u00e9tecter l'alignement des paragraphes",
        "ru": "\u041e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c \u0432\u044b\u0440\u0430\u0432\u043d\u0438\u0432\u0430\u043d\u0438\u0435 \u0430\u0431\u0437\u0430\u0446\u0435\u0432",
        "ko": "\ub2e8\ub77d \uc815\ub82c \uac10\uc9c0",
    },
    "检测段落编号变化": {
        "en": "Detect numbering changes",
        "es": "Detectar cambios en numeraci\u00f3n de p\u00e1rrafos",
        "pt": "Detectar altera\u00e7\u00f5es de numera\u00e7\u00e3o de par\u00e1grafos",
        "ja": "\u6bb5\u843d\u756a\u53f7\u306e\u5909\u5316\u3092\u691c\u51fa",
        "de": "Absatznummerierung erkennen",
        "fr": "D\u00e9tecter la num\u00e9rotation des paragraphes",
        "ru": "\u041e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c \u043d\u0443\u043c\u0435\u0440\u0430\u0446\u0438\u044e \u0430\u0431\u0437\u0430\u0446\u0435\u0432",
        "ko": "\ub2e8\ub77d \ubc88\ud638 \ubcc0\uacbd \uac10\uc9c0",
    },
    "检测图片变动": {
        "en": "Detect image changes",
        "es": "Detectar cambios de im\u00e1genes",
        "pt": "Detectar altera\u00e7\u00f5es em imagens",
        "ja": "\u753b\u50cf\u306e\u5909\u66f4\u3092\u691c\u51fa",
        "de": "Bild\u00e4nderungen erkennen",
        "fr": "D\u00e9tecter les modifications d'image",
        "ru": "\u041e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0439",
        "ko": "\uc774\ubbf8\uc9c0 \ubcc0\uacbd \uac10\uc9c0",
    },
    "检测表格变动": {
        "en": "Detect table changes",
        "es": "Detectar cambios de tablas",
        "pt": "Detectar altera\u00e7\u00f5es em tabelas",
        "ja": "\u8868\u306e\u5909\u66f4\u3092\u691c\u51fa",
        "de": "Tabellen\u00e4nderungen erkennen",
        "fr": "D\u00e9tecter les modifications de tableau",
        "ru": "\u041e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0442\u0430\u0431\u043b\u0438\u0446",
        "ko": "\ud45c \ubcc0\uacbd \uac10\uc9c0",
    },
    "全选": {
        "en": "Select All",
        "es": "Seleccionar todo",
        "pt": "Selecionar tudo",
        "ja": "\u3059\u3079\u3066\u9078\u629e",
        "de": "Alle ausw\u00e4hlen",
        "fr": "Tout s\u00e9lectionner",
        "ru": "\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0432\u0441\u0435",
        "ko": "\ubaa8\ub450 \uc120\ud0dd",
    },
    "🔍 {name} 快照对比": {
        "en": "🔍 Snapshot compare for {name}",
        "es": "\ud83d\udd0d Comparaci\u00f3n de instant\u00e1neas de {name}",
        "pt": "\ud83d\udd0d Comparacao de snapshots de {name}",
        "ja": "\ud83d\udd0d {name}\u306e\u30b9\u30ca\u30c3\u30d7\u6bd4\u8f83",
        "de": "\ud83d\udd0d Snapshot-Vergleich f\u00fcr {name}",
        "fr": "\ud83d\udd0d Comparaison de snapshot pour {name}",
        "ru": "\ud83d\udd0d \u0421\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0435 \u0441\u043d\u0430\u043f\u0448\u043e\u0442\u043e\u0432 {name}",
        "ko": "\ud83d\udd0d {name} \uc2a4\ub0a0\uc0f7 \ube44\uad50",
    },
    "… {count} 段未变 …": {
        "en": "… {count} unchanged paragraphs …",
        "es": "… {count} p\u00e1rrafos sin cambios …",
        "pt": "… {count} par\u00e1grafos sem altera\u00e7\u00e3o …",
        "ja": "… {count} \u30d1\u30e9\u30b0\u30e9\u30d5\u5909\u66f4\u306a\u3057 …",
        "de": "… {count} unver\u00e4nderte Abs\u00e4tze …",
        "fr": "… {count} paragraphes inchang\u00e9s …",
        "ru": "… {count} \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u0430\u0431\u0437\u0430\u0446\u0435\u0432 …",
        "ko": "… {count}\uac1c \ub2e8\ub77d \ubcc0\ud654 \uc5c6\uc74c …",
    },
    "全选": {
        "en": "Select All",
        "es": "Seleccionar todo",
        "pt": "Selecionar tudo",
        "ja": "\u3059\u3079\u3066\u9078\u629e",
        "de": "Alle ausw\u00e4hlen",
        "fr": "Tout s\u00e9lectionner",
        "ru": "\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0432\u0441\u0435",
        "ko": "\ubaa8\ub450 \uc120\ud0dd",
    },
    "🔍 {name} 快照对比": {
        "en": "🔍 Snapshot compare for {name}",
        "es": "\ud83d\udd0d Comparaci\u00f3n de instant\u00e1neas de {name}",
        "pt": "\ud83d\udd0d Comparacao de snapshots de {name}",
        "ja": "\ud83d\udd0d {name}\u306e\u30b9\u30ca\u30c3\u30d7\u6bd4\u8f83",
        "de": "\ud83d\udd0d Snapshot-Vergleich f\u00fcr {name}",
        "fr": "\ud83d\udd0d Comparaison de snapshot pour {name}",
        "ru": "\ud83d\udd0d \u0421\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0435 \u0441\u043d\u0430\u043f\u0448\u043e\u0442\u043e\u0432 {name}",
        "ko": "\ud83d\udd0d {name} \uc2a4\ub0a0\uc0f7 \ube44\uad50",
    },
    "… {count} 段未变 …": {
        "en": "… {count} unchanged paragraphs …",
        "es": "… {count} p\u00e1rrafos sin cambios …",
        "pt": "… {count} par\u00e1grafos sem altera\u00e7\u00e3o …",
        "ja": "… {count} \u30d1\u30e9\u30b0\u30e9\u30d5\u5909\u66f4\u306a\u3057 …",
        "de": "… {count} unver\u00e4nderte Abs\u00e4tze …",
        "fr": "… {count} paragraphes inchang\u00e9s …",
        "ru": "… {count} \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u0430\u0431\u0437\u0430\u0446\u0435\u0432 …",
        "ko": "… {count}\uac1c \ub2e8\ub77d \ubcc0\ud654 \uc5c6\uc74c …",
    }
}

# Populate other languages with English text if missing
for mapping in _TRANSLATIONS.values():
    en = mapping.get("en")
    if en:
        for code in SUPPORTED_LANGUAGES:
            if code not in ("zh", "en") and code not in mapping:
                mapping[code] = en

class _I18N(QObject):
    language_changed = pyqtSignal()


i18n = _I18N()

_current_lang = None


def get_language() -> str:
    global _current_lang
    if _current_lang is None:
        _current_lang = QSettings().value("ui/language", "zh")
    return _current_lang


def set_language(lang: str) -> None:
    global _current_lang
    if lang == _current_lang:
        return
    _current_lang = lang
    QSettings().setValue("ui/language", lang)
    i18n.language_changed.emit()


def _(text: str) -> str:
    lang = get_language()
    trans = _TRANSLATIONS.get(text, {})
    if lang in trans:
        return trans[lang]
    if lang != "zh" and "en" in trans:
        return trans["en"]
    return text
