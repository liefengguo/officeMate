# OfficeMate



------





## **🧱 当前项目结构概览**



```
officeMate_proj/
├── main.py                       # 启动入口（加载主界面 MainDashboard）
├── app/
│   ├── main_dashboard.py         # 🏠 项目主页：显示并管理文档项目列表
│   ├── snapshot_history.py       # 📜 快照历史界面：展示、对比、预览快照
│   ├── diff_viewer.py            # 🔍 差异对比窗口
│   ├── preview_window.py         # 📖 快照内容预览窗口
│   ├── project_delegate.py       # 🎨 自定义列表项绘制样式
├── core/
│   ├── snapshot.py               # 🧠 快照创建与管理（多文档类型支持）
│   ├── version_db.py             # 💾 快照元信息存储（JSON）
│   ├── diff_engine.py            # 🔍 文本差异计算（支持文本 + docx）
│   ├── utils.py                  # 🛠 通用工具函数（hash、路径等）
│   └── recent_db.py              # 🗂 最近打开文档数据库（JSON）
├── assets/                       # 图标、主题等资源
├── config.ini                    # 可选配置（字体、快捷键等）
```





------





## **✅ 已实现核心功能**



| **功能模块** | **描述**                       | **备注**                         |
| ------------ | ------------------------------ | -------------------------------- |
| 主界面主页   | 展示最近文档列表，点击进入项目 | 使用自定义绘制美化，VSCode 风格  |
| 添加项目     | 选择一个文档进行版本控制       | 支持 .txt, .docx                 |
| 快照系统     | 创建文档快照，记录变更         | 支持多格式、自动保存内容和元信息 |
| 快照历史     | 展示所有历史快照，按时间顺序   | JSON 存储                        |
| 快照对比     | 选中两个版本进行内容差异比较   | 富文本高亮、统一格式处理         |
| 快照预览     | 单个快照内容查看               | 支持 .txt 和 .docx 自动判断      |





------





## **🧠 设计理念：七大设计原则应用**



| **设计原则**     | **当前体现**                                                 |
| ---------------- | ------------------------------------------------------------ |
| **SRP 单一职责** | 各模块分明，如 snapshot_history 只负责快照历史，diff_viewer 只负责差异对比 |
| **OCP 开闭原则** | SnapshotStrategy 支持扩展不同格式的快照逻辑（docx/txt）无需修改主流程 |
| **LSP 里氏替换** | 所有策略类均可被替换用于不同文档格式                         |
| **ISP 接口隔离** | UI 控件与后端逻辑解耦（如 version_db.py 只提供数据接口）     |
| **DIP 依赖反转** | 快照系统依赖抽象策略类，不依赖具体格式                       |
| **CRP 合成复用** | SnapshotManager 组合了策略列表 + 元信息存储                  |
| **DRY 不重复**   | 工具函数集中在 utils.py 复用通用逻辑                         |





------





## **📅 接下来开发计划（建议路线）**







### **✅ 阶段一：基础完善与优化**



| **模块**   | **内容**                                         |
| ---------- | ------------------------------------------------ |
| ✅ 主界面   | ✅ 交互完成，下一步可加入图标、拖拽排序、右键菜单 |
| ✅ 快照系统 | ✅ 已实现，后期可支持自定义备注、标签             |
| 🔄 快照备注 | 每个快照附带备注（用户填写）                     |
| 🔄 快照删除 | 支持从历史中删除快照                             |





------





### **✅ 阶段二：扩展功能**



| **模块**       | **功能建议**                       |
| -------------- | ---------------------------------- |
| 🧠 智能快照建议 | 检测变更自动提醒保存快照           |
| 🏷 快照标签     | 快照可以分类（如“初稿”、“修改稿”） |
| 📦 快照导出     | 可导出某个版本为新文档             |
| 📁 项目分组     | 按文件夹或标签对项目分类           |
| 🌙 深色主题     | 支持界面主题切换                   |
| 🔑 权限控制     | 支持文档访问控制（未来可同步云端） |





------





## **🧭 推荐下一步开发任务**





1. 🏷 为快照添加“备注”功能（UI+保存逻辑）
2. 🧽 清理快照（添加删除按钮 + 数据更新）
3. 📎 快照导出为 .docx（复制原始文件）
4. 🧱 全局设置页（设置字体、主题）





------





## **✅ 现在你可以选择的方向：**





- 🔨 **继续开发快照备注 + 删除功能**
- 🎨 **增强主界面（图标、拖拽排序、右键菜单）**
- ☁️ **添加“导出快照”按钮**
- 🧱 **整理并生成项目文档（README、注释等）**



